(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[95],{4202:function(e,t,s){Promise.resolve().then(s.bind(s,1914))},4697:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(7461).Z)("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]])},94:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(7461).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},489:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(7461).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},2235:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(7461).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},1914:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return j}});var r=s(3827),a=s(4090),c=s(94),l=s(4697),i=s(7731),n=s(489),d=s(2235),o=s(575),u=s(5671),h=s(2782),x=s(2647),p=s(5887),m=s(4958),g=s(6288);function j(){let[e,t]=(0,a.useState)([]),[s,j]=(0,a.useState)(!0),[y,k]=(0,a.useState)(!1),[f,v]=(0,a.useState)(null),[b,N]=(0,a.useState)({name:"",category:"",base_price:"",stock:"",stock_status:"In Stock",unit_type:"Qty"}),[_,w]=(0,a.useState)(null),S=async()=>{j(!0),w(null);let{data:e,error:s}=await m.O.from("products").select("*").order("name");if(s){let e="Fetch Failed: ".concat(s.message," (Code: ").concat(s.code,")");g.toast.error(e),w(e),console.error(s)}else t(e||[]);j(!1)};(0,a.useEffect)(()=>{S()},[]);let C=e=>{if(e){var t;v(e),N({name:e.name,category:e.category||"",base_price:e.base_price.toString(),stock:(null===(t=e.stock)||void 0===t?void 0:t.toString())||"0",stock_status:e.stock_status||"In Stock",unit_type:e.unit_type||"Qty"})}else v(null),N({name:"",category:"",base_price:"",stock:"0",stock_status:"In Stock",unit_type:"Qty"});k(!0)},Z=async e=>{e.preventDefault();let t=parseFloat(b.base_price),s=parseFloat(b.stock);if(isNaN(t)){g.toast.error("Invalid price");return}let r={name:b.name,category:b.category,base_price:t,stock:isNaN(s)?0:s,stock_status:b.stock_status,unit_type:b.unit_type};try{if(f&&f.id){let{error:e}=await m.O.from("products").update(r).eq("id",f.id);if(e)throw e;g.toast.success("Product updated")}else{let{error:e}=await m.O.from("products").insert([r]);if(e)throw e;g.toast.success("Product created")}k(!1),S()}catch(t){console.error("Detailed Error:",t);let e="Save Failed: ".concat(t.message||JSON.stringify(t));g.toast.error(e),w(e)}},I=async e=>{if(confirm("Are you sure you want to delete this product?"))try{let{error:t}=await m.O.from("products").delete().eq("id",e);if(t)throw t;g.toast.success("Product deleted"),S()}catch(e){g.toast.error(e.message)}};return(0,r.jsxs)("div",{className:"space-y-4",children:[_&&(0,r.jsxs)("div",{className:"bg-destructive/15 text-destructive p-4 rounded-md border border-destructive/20 font-bold whitespace-pre-wrap",children:["CRITICAL ERROR: ",_]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold tracking-tight",children:"Products"}),(0,r.jsxs)(o.z,{onClick:()=>C(),children:[(0,r.jsx)(c.Z,{className:"mr-2 h-4 w-4"}),"Add Product"]})]}),(0,r.jsxs)(u.Zb,{children:[(0,r.jsx)(u.Ol,{children:(0,r.jsx)(u.ll,{children:"Global Catalog"})}),(0,r.jsx)(u.aY,{children:(0,r.jsx)("div",{className:"relative w-full overflow-auto",children:(0,r.jsxs)(p.iA,{children:[(0,r.jsx)(p.xD,{children:(0,r.jsxs)(p.SC,{children:[(0,r.jsx)(p.ss,{children:"Name"}),(0,r.jsx)(p.ss,{children:"Category"}),(0,r.jsx)(p.ss,{children:"Unit"}),(0,r.jsx)(p.ss,{children:"Base Price (RM)"}),(0,r.jsx)(p.ss,{children:"Stock"})," ",(0,r.jsx)(p.ss,{children:"Global Status"}),(0,r.jsx)(p.ss,{className:"text-right",children:"Actions"})]})}),(0,r.jsxs)(p.RM,{children:[0===e.length&&!s&&(0,r.jsx)(p.SC,{children:(0,r.jsx)(p.pj,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:"No products found. Add one to get started."})}),e.map(e=>{var t;return(0,r.jsxs)(p.SC,{children:[(0,r.jsx)(p.pj,{className:"font-medium",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(l.Z,{className:"h-4 w-4 text-muted-foreground"}),e.name]})}),(0,r.jsx)(p.pj,{children:e.category}),(0,r.jsx)(p.pj,{children:e.unit_type||"Qty"}),(0,r.jsx)(p.pj,{children:null===(t=e.base_price)||void 0===t?void 0:t.toFixed(2)}),(0,r.jsx)(p.pj,{children:Number(e.stock||0).toFixed(2)})," ",(0,r.jsx)(p.pj,{children:(0,r.jsx)("span",{className:"inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium ".concat("In Stock"===e.stock_status?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300":"Low Stock"===e.stock_status?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300"),children:e.stock_status||"In Stock"})}),(0,r.jsxs)(p.pj,{className:"text-right space-x-2",children:[(0,r.jsx)(o.z,{variant:"ghost",size:"icon",onClick:()=>C(e),children:(0,r.jsx)(i.Z,{className:"h-4 w-4"})}),(0,r.jsx)(o.z,{variant:"ghost",size:"icon",className:"text-red-500 hover:text-red-600",onClick:()=>I(e.id),children:(0,r.jsx)(n.Z,{className:"h-4 w-4"})})]})]},e.id)})]})]})})})]}),y&&(0,r.jsx)("div",{className:"fixed inset-0 z-50 bg-black/50 flex items-center justify-center p-4",children:(0,r.jsxs)(u.Zb,{className:"w-full max-w-lg bg-background shadow-lg animate-in fade-in zoom-in duration-200",children:[(0,r.jsxs)(u.Ol,{className:"flex flex-row items-center justify-between border-b px-6 py-4",children:[(0,r.jsx)(u.ll,{children:f?"Edit Product":"Add Product"}),(0,r.jsx)(o.z,{variant:"ghost",size:"icon",onClick:()=>k(!1),children:(0,r.jsx)(d.Z,{className:"h-4 w-4"})})]}),(0,r.jsx)(u.aY,{className:"p-6",children:(0,r.jsxs)("form",{onSubmit:Z,className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsx)(x._,{htmlFor:"name",children:"Name"}),(0,r.jsx)(h.I,{id:"name",required:!0,value:b.name,onChange:e=>N({...b,name:e.target.value}),placeholder:"Chicken Breast"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsx)(x._,{htmlFor:"category",children:"Category"}),(0,r.jsx)(h.I,{id:"category",value:b.category,onChange:e=>N({...b,category:e.target.value}),placeholder:"Raw, Parts"})]}),(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsx)(x._,{htmlFor:"unit_type",children:"Unit Type"}),(0,r.jsxs)("select",{id:"unit_type",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm",value:b.unit_type,onChange:e=>N({...b,unit_type:e.target.value}),children:[(0,r.jsx)("option",{value:"Qty",children:"Qty (Pcs)"}),(0,r.jsx)("option",{value:"Kg",children:"Weight (Kg)"})]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsx)(x._,{htmlFor:"price",children:"Base Price (RM)"}),(0,r.jsx)(h.I,{id:"price",type:"number",step:"0.01",required:!0,value:b.base_price,onChange:e=>N({...b,base_price:e.target.value}),placeholder:"0.00"})]}),(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsx)(x._,{htmlFor:"stock",children:"Current Stock"})," ",(0,r.jsx)(h.I,{id:"stock",type:"number",step:"0.01",required:!0,value:b.stock,onChange:e=>N({...b,stock:e.target.value}),placeholder:"0.00"})]})]}),(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsx)(x._,{htmlFor:"status",children:"Global Stock Status"}),(0,r.jsxs)("select",{id:"status",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm",value:b.stock_status,onChange:e=>N({...b,stock_status:e.target.value}),children:[(0,r.jsx)("option",{value:"In Stock",children:"In Stock"}),(0,r.jsx)("option",{value:"Low Stock",children:"Low Stock"}),(0,r.jsx)("option",{value:"Out of Stock",children:"Out of Stock"})]})]}),(0,r.jsxs)("div",{className:"flex justify-end gap-2 pt-4",children:[(0,r.jsx)(o.z,{type:"button",variant:"outline",onClick:()=>k(!1),children:"Cancel"}),(0,r.jsx)(o.z,{type:"submit",children:"Save Changes"})]})]})})]})})]})}}},function(e){e.O(0,[150,620,688,288,543,971,69,744],function(){return e(e.s=4202)}),_N_E=e.O()}]);