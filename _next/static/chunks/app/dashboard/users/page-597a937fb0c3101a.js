(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[618],{4159:function(e,s,l){Promise.resolve().then(l.bind(l,4520))},489:function(e,s,l){"use strict";l.d(s,{Z:function(){return r}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,l(7461).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},2235:function(e,s,l){"use strict";l.d(s,{Z:function(){return r}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,l(7461).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},4520:function(e,s,l){"use strict";l.r(s),l.d(s,{default:function(){return f}});var r=l(3827),t=l(4090),a=l(7731),n=l(489),i=l(2235),c=l(575),d=l(5671),o=l(2782),u=l(2647),x=l(5887),h=l(4958),m=l(6288);function f(){let[e,s]=(0,t.useState)([]),[l,f]=(0,t.useState)(!0),[j,p]=(0,t.useState)(!1),[g,y]=(0,t.useState)(null),[b,v]=(0,t.useState)({full_name:"",role:"user"}),k=async()=>{f(!0);let{data:e,error:l}=await h.O.from("profiles").select("*").order("full_name");l?(m.toast.error("Failed to load users"),console.error(l)):s(e||[]),f(!1)};(0,t.useEffect)(()=>{k()},[]);let N=e=>{y(e),v({full_name:e.full_name||"",role:e.role||"user"}),p(!0)},w=async e=>{if(e.preventDefault(),g)try{let{error:e}=await h.O.from("profiles").update({full_name:b.full_name,role:b.role}).eq("id",g.id);if(e)throw e;m.toast.success("User updated"),p(!1),k()}catch(e){m.toast.error(e.message)}},_=async e=>{if(confirm("Are you sure you want to delete this user? This removes their profile data only."))try{let{error:s}=await h.O.from("profiles").delete().eq("id",e);if(s)throw s;m.toast.success("Profile deleted"),k()}catch(e){m.toast.error(e.message)}};return(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("div",{className:"flex items-center justify-between",children:(0,r.jsx)("h1",{className:"text-2xl font-bold tracking-tight",children:"Users"})}),(0,r.jsxs)(d.Zb,{children:[(0,r.jsx)(d.Ol,{children:(0,r.jsx)(d.ll,{children:"All Users"})}),(0,r.jsx)(d.aY,{children:(0,r.jsxs)(x.iA,{children:[(0,r.jsx)(x.xD,{children:(0,r.jsxs)(x.SC,{children:[(0,r.jsx)(x.ss,{children:"Name"}),(0,r.jsx)(x.ss,{children:"Role"}),(0,r.jsx)(x.ss,{className:"text-right",children:"Actions"})]})}),(0,r.jsxs)(x.RM,{children:[0===e.length&&!l&&(0,r.jsx)(x.SC,{children:(0,r.jsx)(x.pj,{colSpan:3,className:"text-center py-8 text-muted-foreground",children:"No users found."})}),e.map(e=>(0,r.jsxs)(x.SC,{children:[(0,r.jsx)(x.pj,{className:"font-medium",children:e.full_name}),(0,r.jsx)(x.pj,{children:(0,r.jsx)("span",{className:"inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium ".concat("admin"===e.role?"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300":"manager"===e.role?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300":"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-300"),children:e.role})}),(0,r.jsxs)(x.pj,{className:"text-right space-x-2",children:[(0,r.jsx)(c.z,{variant:"ghost",size:"icon",onClick:()=>N(e),children:(0,r.jsx)(a.Z,{className:"h-4 w-4"})}),(0,r.jsx)(c.z,{variant:"ghost",size:"icon",className:"text-red-500 hover:text-red-600",onClick:()=>_(e.id),children:(0,r.jsx)(n.Z,{className:"h-4 w-4"})})]})]},e.id))]})]})})]}),j&&(0,r.jsx)("div",{className:"fixed inset-0 z-50 bg-black/50 flex items-center justify-center p-4",children:(0,r.jsxs)(d.Zb,{className:"w-full max-w-lg bg-background shadow-lg animate-in fade-in zoom-in duration-200",children:[(0,r.jsxs)(d.Ol,{className:"flex flex-row items-center justify-between border-b px-6 py-4",children:[(0,r.jsx)(d.ll,{children:"Edit User"}),(0,r.jsx)(c.z,{variant:"ghost",size:"icon",onClick:()=>p(!1),children:(0,r.jsx)(i.Z,{className:"h-4 w-4"})})]}),(0,r.jsx)(d.aY,{className:"p-6",children:(0,r.jsxs)("form",{onSubmit:w,className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsx)(u._,{htmlFor:"fullname",children:"Full Name"}),(0,r.jsx)(o.I,{id:"fullname",required:!0,value:b.full_name,onChange:e=>v({...b,full_name:e.target.value})})]}),(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsx)(u._,{htmlFor:"role",children:"Role"}),(0,r.jsxs)("select",{id:"role",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm",value:b.role,onChange:e=>v({...b,role:e.target.value}),children:[(0,r.jsx)("option",{value:"user",children:"User"}),(0,r.jsx)("option",{value:"cashier",children:"Cashier"}),(0,r.jsx)("option",{value:"manager",children:"Manager"}),(0,r.jsx)("option",{value:"admin",children:"Admin"})]})]}),(0,r.jsxs)("div",{className:"flex justify-end gap-2 pt-4",children:[(0,r.jsx)(c.z,{type:"button",variant:"outline",onClick:()=>p(!1),children:"Cancel"}),(0,r.jsx)(c.z,{type:"submit",children:"Save Changes"})]})]})})]})})]})}}},function(e){e.O(0,[150,620,688,288,543,971,69,744],function(){return e(e.s=4159)}),_N_E=e.O()}]);